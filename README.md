# mathemagic
Using number theory and brute force computation, this project is used to aid a performer in giving a participant the illusion of choice.

## Installation
<!-- From the "executables" folder of this repository, download the file cooresponding to your operating system.<br>
The executable requires [Latex](https://www.latex-project.org/get/) to be installed on your system. -->
Install the numpy and pylatex [Python libraries](https://docs.python.org/3/installing/index.html) before [cloning](https://docs.github.com/en/github/creating-cloning-and-archiving-repositories/cloning-a-repository) or downloading this repository.<br>
The script requires [Latex](https://www.latex-project.org/get/) to be installed on your system.<br>
The project was developed in Python3.9 and may not work properly in other versions of Python.


## Usage
To start the program, run the \_\_main\_\_.py file or the entire project folder directly:
```bash
python3 mathemagic
```
Any documents generated by the script will appear in the directory that you are running the script from.

### First Round
First, the script will prompt you to enter an email address, but you can press enter to skip (this will not affect the execution of the script). The script then shows a list of numbers to choose from, enter 4 to select the fourth number for example. You will then be asked to input the participantâ€™s revealed digits (no spaces). The program assumes that the participant never chooses a zero as the digit of the product to keep secret.

After pressing enter, the program will either find the participants number and jump to the matrix section, or display a few possibilities for the secret number and proceed to the second round.

### Second Round
The program will display a list of choices to give to the participant, and ask for which one the participant chose. After pressing enter, the program will ask for the digits the participant revealed (again, enter the digits without spaces). Once this is entered, the secret number will be displayed and the program will proceed to the matrix section.

### Matrix Section
The program generates a file named "matrices.pdf" containing a number of different forcing matrices, and asks you which one the participant chose. Once this is entered, "select_entries.csv" will be generated. 
Open this file as a spreadsheet to see a list of colors (as well as the previously selected matrix). Put coordinates (period seperated) in the color cell (or the cell directly below it) to select a color and a matrix entry all at once (ex: 'white1.2' in the first cell)
When you are done marking invariant entries and color names, save the spreadsheet and press enter in the terminal prompt. You will then be asked if the participant's forcing matrix should be swapped. Press enter at the command line prompt to scramble the forcing matrix and doctor the color grid. A mailto link will also be printed, if an email address was entered you can open this link in a browser to quickly and easily open and edit a draft email.

## Documentation
### color_matrix.ColorMatrix

A class for managing the grid of colors printed to the latex document
```python
get_strDict(self, rgbDict=None)
```
Returns a dict mapping color names to latex commands that render said colors.
Takes as input a dict mapping color names to rgb values, if rgbDict=None ColorMatrix will use self.rgbDict (corresponding to the colors on the zoom color pallet).

```python
get_color_matrix(self, n: int, m: int)
```
Returns an n by m np.array of random colors (in the form of latex commands) sampled from get_strDict().

```python
get_doctored_matrix(self, matrix: np.array, coord_dict: dict)
```
`matrix`: an np.array of colors in the form of latex commands (the output of get_color_matrix())<br>
`coord_dict`: dictionary mapping from tuples of coordinates to color names

Swaps the colors around in the input matrix such that the indeces in coord_dict will hold the colors specified in coord_dict.


### force_matrix.MatrixHandler
A class for managing forcing matrices.

```python
__init__(self, f=None, 
                pdf_filename='matrices', 
                csv_filename='select_entries.csv', 
                percent_change=20,
                perm_fixed_entries=[(0,0)],
                constrain_digits=True):
```
`f`: when generating matrices, this is used by default as the number to force if none us specified<br>
`pdf_filename`: filename the handler should print latex to<br>
`csv_filename`: filename the handler should use when asking the user to input entries<br>
`percent_change`: when altering matrices, this is used by default as the percentage of entries that are altered<br>
`perm_fixed_entries`: entries that should alway remain the same<br>
`constrain_digits`: flag to ensure that the number of digits in each position remain the same throughoyt shuffling and altering

```python
get_rand_positive_seeds(self, n: int, f=None)
```
Returns a np.array of seeds suitable for forcing the number f in an n by n matrix. All values returned are positive integers.

```python
get_rand_int_seeds(self, n: int, f: int, bound: int)
```
Returns a np.array of seeds suitable for forcing the number f in an n by n matrix. All values returned are integers.<br>
`bound`: the maximum amplitude any returned value can have

```python
get_exterior_matrix(self, seeds: list, n: int)
```
Returns a forcing matrix constructed from the input seeds of size n by n. The seed values will not be visible inside the returned matrix.

```python
get_interior_matrix(self, seeds: list, n: int, rand_order=True)
```
Returns a forcing matrix constructed from the input seeds of size n by n. The seed values will be visible inside the returned matrix. 
If rand_order=True thinput seeds are shuffled before being used to onstruct the forcing matrix.


```python
get_shuffled_matrix(self, matrix: np.array, fixed_entries=[], constrain_digits=None)
```
Returns a shuffled version of the input matrix (elements are swapped around). The elements at the indeces specified in `fixed_entries` will not be changed.<br>
`constrain_digits`: flag to ensure that the number of digits in each position remain the same. If constrain_digits=None, defaults to self.constrain_digits

```python
get_altered_matrix(self, matrix: np.array, bound: int, fixed_entries=[], percent_change=None, constrain_digits=None)
```
Returns a randomly altered version of the input matrix (elements are replaced with random values). The elements at the indeces specified in `fixed_entries` will not be changed.<br>
`percent_change`: percentage of entries that are altered. If percent_change=None, defaults to self.percent_change
`constrain_digits`: flag to ensure that the number of digits in each position remain the same. If constrain_digits=None, defaults to self.constrain_digits


```python
print_to_pdf(self, matrices: list, color_matrices: list, filename=None, add_borders=True)
```
Generates a pdf (using latex) tha displays the input matrices andd color matrices.

```python
get_fixed_entries(self, matrix: np.array, filename=None)
```
Generates a csv displaying the input matrix and asks the user to select entries. More information in the Usage section


### secret_number.Performer
A class to help determine a participant's secret number. More information in the Usage section.

```python
get_digits(self, revealed_digits: str)
```
Given all but one non-zero digit, finds the last digit and returns all the digits

```python
get_pos_digits(self, revealed_digits: list, total_digits: int)
```
Given some digits and the total number of digits, returns the possible digits

```python
get_possibilities(self, digits, revealed_num=None, r=100)
```
Given the product digits in any order, returns possible secret numbers

```python
filtered_choices(self, possibilities1: list, revealed_num=None, choices=None)
```
Returns choices that will lead to just one possibility in the second round
